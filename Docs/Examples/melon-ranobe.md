# melon-ranobe
**melon-ranobe** – это универсальный расширяемый rolling-формат описательных файлов ранобэ, использующийся в Melon.

# Основные принципы
* _**Интернациональность**_ – язык контента указывается по стаднарту ISO 639-3, а локализованное название обязано соответствовать ему.
* _**Классификация глав**_ – для удобства обработчиков поставляется перечень типов, которые могут характеризовать главу.

### Типы глав
| **Тип**     | **Определение**                                                                                   |
|-------------|---------------------------------------------------------------------------------------------------|
| _afterword_ | Послесловие автора, оригинального редактора или издателя.                                         |
| _art_       | Иллюстрации и дополнительные арты.                                                                |
| _chapter_   | Данный тип выставляется, когда точно известно, что глава не принадлежит ни к одному другому типу. |
| _epilogue_  | Эпилог.                                                                                           |
| _extra_     | Бонусные истории, экстра-главы, интервью с авторами и т.д.                                        |
| _glossary_  | Глоссарий, список персонажей или данные о вселенной произведения.                                 |
| _prologue_  | Пролог.                                                                                           |
| _trash_     | Дополнительные главы с рекламой, в том числе переводчиков, и примечаниями.                        |

* _**Максимальная однозначность**_ – каждое поле имеет или заранее определённый тип с валидным значением, либо же является `null` или пустой структурой при отсутствии данных.
* _**Независимость**_ – формат полностью абстрагирован от источников и не является специфичным для какого-либо из них.
* _**Порядковый индекс**_ – индекс слайда соответствует его порядковому номеру в главе, то есть нумеруется с единицы для удобства считывания данных человеком.
* _**Расширяемость**_ – парсеры могут предоставлять дополнительные данные, не описанные в данном манифесте.
* _**Синтетические идентификаторы**_ – если тайтл, ветвь или глава не имеет целочисленного идентификатора, таковой будет сгенерирован с условием повторяемости результата и уникальности в разрезе источника.
* _**Типизация локализацией**_ – вместо типов тайтлов используется язык оригинального контента по стандарту ISO 639-3 (позволянт избежать частой путаницы между новеллами из США и Великобритании).
* _**Только базовый HTML**_ – контент представлен списком абзацев HTML, каждый из которых поддерживает лишь базовый набор разметки. Предпочтение всегда отдаётся односимвольным тегам, так как они занимают меньше места и не имеют фактических отличий от длинных аналогов.

### Соглашение об HTML
| **Теги**     | **Атрибуты**       | **Описание**                                                                                                                                                        |
|--------------|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| _p_          | align              | Родительский тег каждого абзаца. Поддерживает только выравнивание. В абзаце может существовать только один такой тег, исключая блоки **blockquote**.                |
| _b_          | ❌                  | Выделяет текст полужирным. Все теги **strong** автоматически приводятся к этому тегу.                                                                               |
| _i_          | ❌                  | Выделяет текст курсивом. Все теги **em** автоматически приводятся к этому тегу.                                                                                     |
| _s_          | ❌                  | Делает текст перечёркнутым. Все теги **del** и **strike** автоматически приводятся к этому тегу.                                                                    |
| _u_          | ❌                  | Добавляет подчёркивание к тексту.                                                                                                                                   |
| _sup_        | ❌                  | Отображает текст в виде верхнего индекса.                                                                                                                           |
| _sub_        | ❌                  | Отображает текст в виде нижнего индекса.                                                                                                                            |
| _blockquote_ | name               | Семантическое выделение части абзаца. Блоки могут содержать другие абзацы, иллюстрации и теги, а также иметь название, указывающее обработчикам, как их отображать. |
| _img_        | width, height, src | Иллюстрация. Ссылается всегда на локальный файл, может также содержать данные об оригинальном разрешении изображения.                                               |

* _**Уважение труда**_ – переводчики глав всегда указываются в соответствующих полях, если такая информация доступна в источнике.
* _**Чёткие статусы**_ – используются только основные и наиболее информативные статусы.

### Статусы произведения
| **Статус**  | **Значение**                                                                                                                                                                                                                                |
|-------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| _announced_ | Произведение или перевод только анонсированы, контент ещё недоступен.                                                                                                                                                                       |
| _ongoing_   | Означает регулярное поступление контента произведения на языке ресурса. Сочетает в себе как выход глав в оригинале, так и перевод. Например, если главы в оригинале перестали выходить, но перевод продолжается, то этот статус справедлив. |
| _completed_ | Произведение полностью завершено в оригинале и, если требовалось, выполнен его перевод.                                                                                                                                                     |
| _dropped_   | Произведение заброшено автором или не переводится активно.                                                                                                                                                                                  |

* _**Rolling**_ – формат не версионируется и может изменяться без предупреждений и без поддержки обратной совместимости.

# Пример
```json
{
	"format": "melon-ranobe",
	"site": "example.com",
	"id": 123,
	"slug": "ranobe_slug",
	"content_language": "rus",
	"localized_name": "Название ранобэ",
	"en_name": "Ranobe name",
	"another_names": [
		"Ranobe mei"
	],
	"covers": [
		{
			"link": "https://example.com/manga_slug/cover.jpg",
			"filename": "cover.jpg"
		}
	],
	"authors": [
		"Имя автора"
	],
	"publication_year": 2024,
	"description": "Первый абзац описания.\nВторой абзац описания.",
	"age_limit": 16,
	"original_language": "jpn",
	"status": "ongoing",
	"is_licensed": false,
	"genres": [
		"название жанра"
	],
	"tags": [
		"название тега"
	],
	"franchises": [
		"название франшизы"
	],
	"persons": [
		{
			"name": "Имя персонажа",
			"another_names": ["Альтернативные имена персонажа"],
			"images": [
				{
					"link": "https://example.com/person_slug/image.jpg",
					"filename": "image.jpg"
				}
			],
			"description": "Описание персонажа"
		}
	],
	"branches": [
		{
			"id": 123456,
			"chapters_count": 1
		}
	],
	"content": {
		"123456": [
			{
				"id": 1,
				"slug": "vol1-ch1",
				"volume": "1",
				"number": "1",
				"name": "Название главы",
				"type": "chapter",
				"is_paid": false,
				"translators": [
					"Имя переводчика"
				],
				"paragraphs": [
					"<p>Первый абзац.</p>",
					"<p>Второй абзац.</p>"
				]
			}
		]
	}
}
```
